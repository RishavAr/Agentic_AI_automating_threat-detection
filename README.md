
# DAEN-690-NetGuard
# NetGuard – Agentic AI for Real‑Time Network Traffic Monitoring & Proactive Threat Mitigation
> **Course:** DAEN 690 • Spring 2025  
> **Team:** Rishav Aryan · Durga Prasad Esampelly · Artum Khorshid · Prudhvi Sandeep Mudidana · Samhita Sarikonda · Ravi Teja Talluri

---

## 🗒️ Overview
NetGuard is an **AI‑powered cybersecurity agent** that continuously monitors network traffic, fuses it with anomaly logs, and triggers automatic mitigation actions. Built around the **NIST Cybersecurity Framework**, the project showcases:

- **Real‑time detection** of threats from mixed traffic & log streams.
- **Serverless scale** via AWS Lambda + S3 event chaining.
- **LLM‑driven enrichment** using SecureGPT grounded on *NIST SP 800‑53r5*.
- **Hands‑free ticketing** that opens JIRA issues for critical alerts.

The repository contains complete source code, IaC snippets, prompts, diagrams, datasets, and results to reproduce the pipeline end‑to‑end.

---

## 📂 Repository Layout
| Folder | What’s Inside |
|--------|---------------|
| `data/` | Example `network_packets.csv`, `anomaly_logs.csv`, and the NIST PDF |
| `agents/` | Source for the four Lambda functions (Ingestor, Analyzer, Aggregator, Ticket Generator) |
| `prompts/` | Three SecureGPT prompt templates |
| `diagrams/` | Editable draw.io + PNG architecture diagram |
| `results/` | Sample enriched logs and evaluation charts |
| `scripts/` | Shell scripts to deploy and clean up |

---

## 🧪 Datasets Used
- `network_packets.csv`: Simulated network traffic with fields like Protocol, Flags, PacketSize, Status
- `anomaly_logs.csv`: Generated by Faker with AnomalyType, LogLevel, NISTReference
- `NIST.SP.800-53r5.pdf`: Grounding document for SecureGPT

---

## 🏗️ System Architecture
![System Architecture](diagrams/architecture.png)

Four Lambda agents flow in a serverless chain:
1. **NetGuard Ingestor** – Splits raw PCAP/CSV traffic into 100‑row chunks  
2. **NetGuard Analyzer** – Matches each chunk with anomaly logs and calls SecureGPT  
3. **NetGuard Aggregator** – Combines enriched chunks into a final report  
4. **Ticket Generator** – Pushes critical threats to JIRA

---

## 🤖 Agent Breakdown

### 1. NetGuard Ingestor
- **Trigger**: S3 event (new file uploaded)
- **Tasks**: Normalize, chunk, and store logs
- **Output**: 100-row CSV chunks in `netguard-analyzed-chunks/`

### 2. NetGuard Analyzer
- **Input**: Chunked packets + anomaly logs
- **Logic**:
  - Match IPs with anomaly logs
  - Construct structured SecureGPT prompt
  - Receive: ThreatSeverity, ActionTaken, Explanation
- **Output**: Enriched CSV

### 3. NetGuard Aggregator
- **Input**: Analyzed chunks
- **Tasks**: Validate, concatenate, and export full report
- **Output**: Final threat log in `netguard-final-output-logs/`

### 4. NetGuard Ticket Generator
- **Trigger**: New file in final output bucket
- **Logic**:
  - Filter High/Critical threats
  - Push JIRA tickets via API

---

## 🔐 SecureGPT Integration
- Hosted by Accure.ai (fine-tuned LLaMA model)
- **Use cases**: Threat classification, mitigation strategy, and compliance explanation
- **Prompt styles**:
  - Severity Assistant
  - Mitigation Planner
  - Explanation Generator
- **Document grounding**: `NIST.SP.800-53r5.pdf`
- **Response format**: Structured JSON

---

## 📊 Testing & Evaluation
| Dataset Size | Accuracy | Precision | Recall | F1-Score | ROC AUC |
|--------------|----------|-----------|--------|----------|---------|
| 3000 rows    | 90.9%    | 92.4%     | 96.6%  | 94.5%    | 0.93    |
| 6000 rows    | 94.5%    | 91.6%     | 89.9%  | 90.8%    | 0.92    |

- Post-Reflexion Improvements: Reflexive updates improved precision.
- Load Handling: Parallel chunking & SecureGPT invocation scaled efficiently.

![Accuracy vs F1](results/quality_metrics_with_reflection.png)

---

## 🎬 Demo Video

[![Watch Demo](https://img.shields.io/badge/Watch-Demo-blue?logo=google-drive)](https://drive.google.com/file/d/1-fz5eYod2dFaeJBlZmV9zpTHp0o6I0WW/view)

---

## 🚀 Deployment Stack
- **Infrastructure**: AWS Lambda, S3, CloudWatch, IAM
- **Data Handling**: Pandas, boto3
- **Inference API**: SecureGPT (Accure.ai)
- **Ticketing**: JIRA REST API

---

## 🏃‍♂️ Quick Start – Run NetGuard in Your AWS Account

> **~15 minutes** using only `aws cli v2` & Python 3.10

### 0 · Prerequisites
Create a local `.env` (or set env vars in each Lambda):

```dotenv
CYBERSENTINEL_BUCKET=cybersentinel-logs
NETGUARD_BUCKET=netguard-network-traffic-data
NIST_S3_PATH=s3://rishavnist/NIST.SP.800-53r5.pdf
OUTPUT_BUCKET=netguard-final-output-logs
SECUREGPT_URL=https://tis.accure.ai:9001/query
SECUREGPT_TOKEN=<YOUR_TOKEN>
SECUREGPT_ORG=<YOUR_ORG_ID>
SECUREGPT_CERT_PATH=/opt/python/securegpt_cert.pem
JIRA_BASE_URL=https://<your-domain>.atlassian.net
JIRA_API_USER=<email>
JIRA_API_TOKEN=<token>
```

### 1 · Clone & Build

```bash
git clone https://github.com/<your-org>/netguard.git
cd netguard
./scripts/build_all.sh
```

### 2 · Create S3 Buckets

```bash
aws s3 mb s3://cybersentinel-logs
aws s3 mb s3://netguard-network-traffic-data
aws s3 mb s3://netguard-analyzed-chunks
aws s3 mb s3://netguard-final-output-logs
aws s3 mb s3://rishavnist
aws s3 cp data/NIST.SP.800-53r5.pdf s3://rishavnist/
```

### 3 · IAM Role & Policy

```bash
aws iam create-policy --policy-name NetGuardNetworkUploaderPolicy --policy-document file://scripts/iam/lambda-policy.json
aws iam create-role --role-name NetGuardLambdaRole --assume-role-policy-document file://scripts/iam/lambda-trust.json
aws iam attach-role-policy --role-name NetGuardLambdaRole --policy-arn arn:aws:iam::<ACCOUNT_ID>:policy/NetGuardNetworkUploaderPolicy
```

### 4 · Deploy Lambda Functions

```bash
for fn in netguard_ingestor netguard_analyzer netguard_aggregator netguard_ticket_generator
do
  aws lambda create-function     --function-name ${fn^}     --zip-file fileb://dist/$fn.zip     --handler main.handler     --runtime python3.10     --role arn:aws:iam::<ACCOUNT_ID>:role/NetGuardLambdaRole     --environment Variables="$(cat .env | sed 's/^/"/;s/=/":"/;s/$/"/' | paste -sd, -)"
done
```

### 5 · Attach S3 Triggers

```bash
aws s3api put-bucket-notification-configuration   --bucket netguard-network-traffic-data   --notification-configuration '{
      "LambdaFunctionConfigurations":[{
          "LambdaFunctionArn":"arn:aws:lambda:<REGION>:<ACCOUNT_ID>:function:NetguardIngestor",
          "Events":["s3:ObjectCreated:*"]
      }]
  }'
```

Repeat similar setup for the other three Lambda agents.

### 6 · Test the Pipeline

```bash
aws s3 cp data/network_packets.csv s3://netguard-network-traffic-data/
aws s3 cp data/anomaly_logs.csv s3://cybersentinel-logs/
```

Check CloudWatch logs and verify enriched files land in `netguard-final-output-logs/`.

---

## 📈 Future Work

- Add real-time packet capture (PyShark/Scapy)
- Switch to EC2 for higher volume processing
- Integrate Splunk/ELK dashboards from Cyber Vision
- Support other frameworks (MITRE ATT&CK)

---

## 🧠 Team
Rishav Aryan · Durga Prasad Esampelly · Artum Khorshid · Prudhvi Sandeep Mudidana · Samhita Sarikonda · Ravi Teja Talluri

---

## 📚 References

- NIST Cybersecurity Framework  
- Accure Inc. SecureGPT API Docs  
- Erasmus.AI Agentic AI Insights

---

> ✨ Empowering proactive cyber defense through agentic intelligence.
